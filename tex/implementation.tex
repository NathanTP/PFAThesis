The PFA was implemented within the RISC-V ecosystem. RISC-V is an open-source instruction set with several open and closed-source implementations and ports for many common software components\cite{riscv}. I used the RISC-V port of Linux 4.13\cite{rvLinux} with a Buildroot generated user space\cite{rvBuildroot}.

\subsection{PFA Reference Implementation}
In order to accelerate software development, and to provide a golden-model of PFA behavior, I implemented the PFA first in a RISC-V ISA simulator called "Spike"\cite{spike}. Spike provides a functional simulation of a RISC-V core through a straightforward C++ interpreter, but does not provide any timing accuracy. Due to its simplicity, the PFA implementation required only a few weeks of implementation effort and less than 1000 LoC. With Spike, software development was able to proceed concurrently with the concrete hardware design.  Furthermore, unit tests developed under Spike were used to validate the hardware implementation, reducing debugging effort. In all, the only software change that was needed to go from Spike to a concrete implementation was one extra TLB flush due to a difference in TLB design between Spike and the RISC-V implementation we used.

\subsection{Concrete Implementation}
The PFA was implemented in the Chisel hardware construction language\cite{chisel} and integrated with a simple in-order CPU called RocketCore\cite{rocketCore}. The components were integrated using the RocketChip system-on-chip (SoC) generator\cite{rocketChip}. The hardware implementation of this system involved a large number of contributors and is not the main focus of this thesis\todo{How should I properly cite other contributors and make clear that this work was not done by me?}. I provide here an overview of a few relevant subsystems.

\subsubsection{RocketCore and RocketChip}
RocketChip is a framework for generating SoCs. It includes on-chip interconnects, caches, and other utilities for chip construction. While the CPU is pluggable, we use only the RocketCore in-order CPU for our experiments. Our implementation used dedicated 16KB instruction and data caches\todo{I hope to run experiments with an L2 in the future}. 

\subsubsection{PFA Implementations}

\subsection{Linux Integration} \label{sec_linuxImpl}
    \input{tex/linuxDesign.tex}